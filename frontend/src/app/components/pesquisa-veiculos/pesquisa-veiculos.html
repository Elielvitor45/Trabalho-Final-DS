<div class="pesquisa-container">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-content">
      <div class="logo" (click)="goToHome()">
        <span class="logo-icon">üöó</span>
        <span class="logo-text">LocadoraMax</span>
      </div>

      <div class="nav-links">
        <a (click)="goToHome()">Home</a>
        
        <div *ngIf="isAuthenticated" class="nav-user">
          <button class="btn-user-name" (click)="goToPerfil()">
            üë§ Ol√°, {{ firstName }}
          </button>
          <button class="btn-nav-danger" (click)="logout()">
            üö™ Sair
          </button>
        </div>
        
        <button *ngIf="!isAuthenticated" class="btn-primary" (click)="goToLogin()">
          üë§ Entrar
        </button>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <h1 class="hero-title">Encontre o Ve√≠culo Perfeito</h1>
      <p class="hero-subtitle">Explore nossa frota completa e reserve agora mesmo!</p>
    </div>
  </section>

  <!-- Search and Filters -->
  <section class="filters-section">
    <div class="container">
      <!-- Barra de Pesquisa -->
      <div class="search-bar">
        <input 
          type="text" 
          [(ngModel)]="termoPesquisa"
          (keyup.enter)="pesquisar()"
          placeholder="Buscar por modelo, marca ou categoria..."
          class="search-input"
        >
        <button class="btn-search" (click)="pesquisar()">
          üîç Buscar
        </button>
      </div>

      <!-- Filtros de Categoria -->
      <div class="category-filters">
        <button 
          class="filter-btn"
          [class.active]="categoriaSelecionada === 'Todos'"
          (click)="filtrarPorCategoria('Todos')">
          Todos
        </button>
        
        <button 
          *ngFor="let categoria of categorias"
          class="filter-btn"
          [class.active]="categoriaSelecionada === categoria"
          (click)="filtrarPorCategoria(categoria)">
          {{ categoria }}
        </button>
        
        <button 
          *ngIf="categoriaSelecionada !== 'Todos' || termoPesquisa"
          class="btn-clear-filters"
          (click)="limparFiltros()">
          ‚úñ Limpar Filtros
        </button>
      </div>

      <!-- Controles de Visualiza√ß√£o e Resultados -->
      <div class="view-controls">
        <div class="results-info">
          <p *ngIf="!loading">
            <strong>{{ veiculosFiltrados.length }}</strong> 
            {{ veiculosFiltrados.length === 1 ? 've√≠culo encontrado' : 've√≠culos encontrados' }}
          </p>
        </div>

        <div class="view-toggle">
          <button 
            class="view-btn"
            [class.active]="modoVisualizacao === 'grid'"
            (click)="mudarVisualizacao('grid')"
            title="Visualiza√ß√£o em Grade">
            ‚ñ¶ Grade
          </button>
          <button 
            class="view-btn"
            [class.active]="modoVisualizacao === 'lista'"
            (click)="mudarVisualizacao('lista')"
            title="Visualiza√ß√£o em Lista">
            ‚ò∞ Lista
          </button>
          <button 
            class="view-btn"
            [class.active]="modoVisualizacao === 'tabela'"
            (click)="mudarVisualizacao('tabela')"
            title="Visualiza√ß√£o em Tabela">
            ‚ñ§ Tabela
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Carregando ve√≠culos...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage && !loading" class="error-container">
    <div class="error-message">{{ errorMessage }}</div>
    <button class="btn-primary" (click)="loadVeiculos()">üîÑ Tentar Novamente</button>
  </div>

  <!-- Vehicles Section -->
  <section class="vehicles-section" *ngIf="!loading && !errorMessage">
    <div class="container">
      <!-- Nenhum resultado -->
      <div *ngIf="veiculosFiltrados.length === 0" class="no-results">
        <div class="no-results-icon">üöó</div>
        <h2>Nenhum ve√≠culo encontrado</h2>
        <p>Tente ajustar seus filtros ou termos de pesquisa</p>
        <button class="btn-primary" (click)="limparFiltros()">Ver Todos os Ve√≠culos</button>
      </div>

      <!-- VISUALIZA√á√ÉO EM GRADE (GRID) -->
      <div *ngIf="veiculosFiltrados.length > 0 && modoVisualizacao === 'grid'" class="vehicles-grid">
        <div *ngFor="let veiculo of veiculosFiltrados" class="vehicle-card">
          <div class="badge-categoria">{{ veiculo.categoria }}</div>
          
          <div class="vehicle-image-wrapper">
            <img 
              [src]="getImagemVeiculo(veiculo)" 
              [alt]="veiculo.marca + ' ' + veiculo.modelo"
              class="vehicle-image-real"
            >
          </div>
          
          <h3 class="vehicle-title">{{ veiculo.marca }} {{ veiculo.modelo }}</h3>
          <p class="vehicle-year">{{ veiculo.ano }}</p>
          
          <div class="vehicle-price">
            {{ formatarValor(veiculo.valorDiaria) }}<span class="price-period">/dia</span>
          </div>
          
          <ul class="vehicle-features">
            <li><span class="feature-icon">‚úì</span> Placa: {{ veiculo.placa }}</li>
            <li><span class="feature-icon">‚úì</span> {{ veiculo.categoria }}</li>
            <li *ngIf="veiculo.disponivel"><span class="feature-icon">‚úì</span> Dispon√≠vel</li>
          </ul>
          
          <div class="vehicle-actions">
            <button class="btn-details" (click)="verDetalhes(veiculo.id)">
              üëÅÔ∏è Detalhes
            </button>
            <button class="btn-rent" (click)="alugarVeiculo(veiculo.id)">
              {{ isAuthenticated ? 'üöó Alugar' : 'üîí Login' }}
            </button>
          </div>
        </div>
      </div>

      <!-- VISUALIZA√á√ÉO EM LISTA -->
      <div *ngIf="veiculosFiltrados.length > 0 && modoVisualizacao === 'lista'" class="vehicles-list">
        <div *ngFor="let veiculo of veiculosFiltrados" class="vehicle-list-item">
          <div class="list-item-image">
            <img 
              [src]="getImagemVeiculo(veiculo)" 
              [alt]="veiculo.marca + ' ' + veiculo.modelo"
            >
            <div class="list-badge">{{ veiculo.categoria }}</div>
          </div>
          
          <div class="list-item-content">
            <div class="list-item-header">
              <h3 class="list-item-title">{{ veiculo.marca }} {{ veiculo.modelo }}</h3>
              <div class="list-item-price">
                {{ formatarValor(veiculo.valorDiaria) }}<span>/dia</span>
              </div>
            </div>
            
            <p class="list-item-subtitle">Ano: {{ veiculo.ano }} ‚Ä¢ Placa: {{ veiculo.placa }}</p>
            
            <p class="list-item-description" *ngIf="veiculo.descricao">
              {{ veiculo.descricao }}
            </p>
            
            <div class="list-item-features">
              <span class="list-feature">‚úì {{ veiculo.categoria }}</span>
              <span class="list-feature" *ngIf="veiculo.disponivel">‚úì Dispon√≠vel agora</span>
            </div>
          </div>
          
          <div class="list-item-actions">
            <button class="btn-list-details" (click)="verDetalhes(veiculo.id)">
              üëÅÔ∏è Ver Detalhes
            </button>
            <button class="btn-list-rent" (click)="alugarVeiculo(veiculo.id)">
              {{ isAuthenticated ? 'üöó Alugar Agora' : 'üîí Fazer Login' }}
            </button>
          </div>
        </div>
      </div>

      <!-- VISUALIZA√á√ÉO EM TABELA -->
      <div *ngIf="veiculosFiltrados.length > 0 && modoVisualizacao === 'tabela'" class="vehicles-table-wrapper">
        <table class="vehicles-table">
          <thead>
            <tr>
              <th>Imagem</th>
              <th>Ve√≠culo</th>
              <th>Ano</th>
              <th>Categoria</th>
              <th>Placa</th>
              <th>Valor/Dia</th>
              <th>Status</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let veiculo of veiculosFiltrados">
              <td>
                <img 
                  [src]="getImagemVeiculo(veiculo)" 
                  [alt]="veiculo.marca + ' ' + veiculo.modelo"
                  class="table-vehicle-image"
                >
              </td>
              <td class="table-vehicle-name">
                <strong>{{ veiculo.marca }}</strong><br>
                {{ veiculo.modelo }}
              </td>
              <td>{{ veiculo.ano }}</td>
              <td>
                <span class="table-badge">{{ veiculo.categoria }}</span>
              </td>
              <td>{{ veiculo.placa }}</td>
              <td class="table-price">{{ formatarValor(veiculo.valorDiaria) }}</td>
              <td>
                <span class="status-badge" [class.disponivel]="veiculo.disponivel">
                  {{ veiculo.disponivel ? '‚úì Dispon√≠vel' : '‚úó Indispon√≠vel' }}
                </span>
              </td>
              <td class="table-actions">
                <button class="btn-table-action btn-table-details" (click)="verDetalhes(veiculo.id)">
                  üëÅÔ∏è
                </button>
                <button class="btn-table-action btn-table-rent" (click)="alugarVeiculo(veiculo.id)">
                  {{ isAuthenticated ? 'üöó' : 'üîí' }}
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 LocadoraMax. Todos os direitos reservados.</p>
    </div>
  </footer>
</div>
